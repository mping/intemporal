SHADOW_ENV.evalLoad("intemporal.fsm.js", true , "goog.provide(\x27intemporal.fsm\x27);\nintemporal.fsm.extract \x3d (function intemporal$fsm$extract(x,k){\nif(cljs.core.map_QMARK_(x)){\nreturn cljs.core.get.cljs$core$IFn$_invoke$arity$2(x,k);\n} else {\nif((x instanceof cljs.core.Keyword)){\nreturn x;\n} else {\nreturn null;\n}\n}\n});\n/**\n * Given a set of rules for states, a current state and event,\n * figure out the next state and potential side effects to perform.\n * \n * Transit can either be called on a *machine*, i.e: a map containing\n * the current state and rules. In this case, an updated machine map\n * will be returned, with a potentially new state and potential actions\n * to perform if any.\n * \n * When called with the three-arity version, transition rules, state,\n * and event are provided separately. The output is then a transition.\n * \n * Both arities throw when no possible transition was found\n */\nintemporal.fsm.transit \x3d (function intemporal$fsm$transit(var_args){\nvar G__44468 \x3d arguments.length;\nswitch (G__44468) {\ncase 2:\nreturn intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));\n\nbreak;\ncase 3:\nreturn intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));\n\nbreak;\ndefault:\nthrow (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));\n\n}\n});\n\n(intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$2 \x3d (function (p__44469,event){\nvar map__44470 \x3d p__44469;\nvar map__44470__$1 \x3d cljs.core.__destructure_map(map__44470);\nvar machine \x3d map__44470__$1;\nvar rules \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__44470__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885));\nvar state \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__44470__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216));\nvar map__44471 \x3d intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$3(rules,state,event);\nvar map__44471__$1 \x3d cljs.core.__destructure_map(map__44471);\nvar actions \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__44471__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741));\nvar to \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__44471__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634));\nvar G__44474 \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(machine,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),to);\nif((!((actions \x3d\x3d null)))){\nreturn cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__44474,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),actions);\n} else {\nreturn G__44474;\n}\n}));\n\n(intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$3 \x3d (function (rules,state,event){\nvar transitions \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(rules,intemporal.fsm.extract(state,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)));\nvar e \x3d intemporal.fsm.extract(event,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633));\ncljs.core.println.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([state,event], 0));\n\nvar or__5045__auto__ \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__44466_SHARP_,p2__44464_SHARP_){\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633).cljs$core$IFn$_invoke$arity$1(p2__44464_SHARP_),e)){\nreturn cljs.core.reduced(p2__44464_SHARP_);\n} else {\nreturn null;\n}\n}),null,transitions);\nif(cljs.core.truth_(or__5045__auto__)){\nreturn or__5045__auto__;\n} else {\nthrow cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22cannot find transition\x22,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),new cljs.core.Keyword(\x22exoscale.ex\x22,\x22not-found\x22,\x22exoscale.ex/not-found\x22,684973639),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),state,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),event], null));\n}\n}));\n\n(intemporal.fsm.transit.cljs$lang$maxFixedArity \x3d 3);\n\n/**\n * Returns a collection of invalid target states used in\n * \n *   Predicate to check whether a given valid ruleset provides\n * a functioning set of rules. Rules are deemed functioning if\n * all target states are known.\n */\nintemporal.fsm.invalid_states \x3d (function intemporal$fsm$invalid_states(rules){\nvar valid_states \x3d cljs.core.set(cljs.core.keys(rules));\nreturn cljs.core.not_empty(cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentHashSet.EMPTY,cljs.core.comp.cljs$core$IFn$_invoke$arity$variadic(cljs.core.mapcat.cljs$core$IFn$_invoke$arity$1(cljs.core.val),cljs.core.map.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)),cljs.core.distinct.cljs$core$IFn$_invoke$arity$0(),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.remove.cljs$core$IFn$_invoke$arity$1(cljs.core.partial.cljs$core$IFn$_invoke$arity$2(cljs.core.contains_QMARK_,valid_states))], 0)),rules));\n});\n/**\n * Perform sanity checks on a rule set, intended to be ran when loading rules.\n * Throws on badly formulated rules\n */\nintemporal.fsm.validate_rules \x3d (function intemporal$fsm$validate_rules(rules){\nif(cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),rules)){\n} else {\nthrow cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(cljs.spec.alpha.explain_str(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),rules),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),new cljs.core.Keyword(\x22exoscale.ex\x22,\x22incorrect\x22,\x22exoscale.ex/incorrect\x22,-1592182378)], null));\n}\n\nvar temp__5804__auto___44534 \x3d intemporal.fsm.invalid_states(rules);\nif(cljs.core.truth_(temp__5804__auto___44534)){\nvar states_44535 \x3d temp__5804__auto___44534;\nthrow cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core.str,\x22transitions contain invalid states: \x22,cljs.core.interpose.cljs$core$IFn$_invoke$arity$2(\x22, \x22,cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.name,states_44535))),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),new cljs.core.Keyword(\x22exoscale.ex\x22,\x22incorrect\x22,\x22exoscale.ex/incorrect\x22,-1592182378),new cljs.core.Keyword(null,\x22states\x22,\x22states\x22,1389013542),states_44535], null));\n} else {\n}\n\nreturn rules;\n});\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Symbol(\x22cljs.core\x22,\x22qualified-keyword?\x22,\x22cljs.core/qualified-keyword?\x22,-308091478,null),cljs.core.qualified_keyword_QMARK_);\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745),new cljs.core.Symbol(\x22cljs.core\x22,\x22qualified-keyword?\x22,\x22cljs.core/qualified-keyword?\x22,-308091478,null),cljs.core.qualified_keyword_QMARK_);\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Symbol(\x22cljs.core\x22,\x22qualified-keyword?\x22,\x22cljs.core/qualified-keyword?\x22,-308091478,null),cljs.core.qualified_keyword_QMARK_);\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22conform-all\x22,\x22cljs.spec.alpha/conform-all\x22,45201917),true,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kind-form\x22,\x22cljs.spec.alpha/kind-form\x22,-1047104697),null,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22describe\x22,\x22cljs.spec.alpha/describe\x22,1883026911),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745)),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22cpred\x22,\x22cljs.spec.alpha/cpred\x22,-693471218),(function (G__44483){\nreturn cljs.core.coll_QMARK_(G__44483);\n})], null),null));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22keys\x22,\x22cljs.spec.alpha/keys\x22,1109346032,null),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22req-un\x22,\x22req-un\x22,1074571008),new cljs.core.Keyword(null,\x22opt-un\x22,\x22opt-un\x22,883442496),new cljs.core.Keyword(null,\x22gfn\x22,\x22gfn\x22,791517474),new cljs.core.Keyword(null,\x22pred-exprs\x22,\x22pred-exprs\x22,1792271395),new cljs.core.Keyword(null,\x22keys-pred\x22,\x22keys-pred\x22,858984739),new cljs.core.Keyword(null,\x22opt-keys\x22,\x22opt-keys\x22,1262688261),new cljs.core.Keyword(null,\x22req-specs\x22,\x22req-specs\x22,553962313),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.Keyword(null,\x22req-keys\x22,\x22req-keys\x22,514319221),new cljs.core.Keyword(null,\x22opt-specs\x22,\x22opt-specs\x22,-384905450),new cljs.core.Keyword(null,\x22pred-forms\x22,\x22pred-forms\x22,172611832),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__44486){\nreturn cljs.core.map_QMARK_(G__44486);\n}),(function (G__44486){\nreturn cljs.core.contains_QMARK_(G__44486,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633));\n}),(function (G__44486){\nreturn cljs.core.contains_QMARK_(G__44486,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634));\n})], null),(function (G__44486){\nreturn ((cljs.core.map_QMARK_(G__44486)) \x26\x26 (((cljs.core.contains_QMARK_(G__44486,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633))) \x26\x26 (cljs.core.contains_QMARK_(G__44486,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634))))));\n}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22map?\x22,\x22cljs.core/map?\x22,-1390345523,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)])));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22conform-all\x22,\x22cljs.spec.alpha/conform-all\x22,45201917),true,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kind-form\x22,\x22cljs.spec.alpha/kind-form\x22,-1047104697),null,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22describe\x22,\x22cljs.spec.alpha/describe\x22,1883026911),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072)),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22cpred\x22,\x22cljs.spec.alpha/cpred\x22,-693471218),(function (G__44495){\nreturn cljs.core.coll_QMARK_(G__44495);\n})], null),null));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22map-of\x22,\x22cljs.spec.alpha/map-of\x22,153715093,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22tuple\x22,\x22cljs.spec.alpha/tuple\x22,-415901908,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)], null)),new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kfn\x22,\x22cljs.spec.alpha/kfn\x22,672643897),(function (i__14719__auto__,v__14720__auto__){\nreturn cljs.core.nth.cljs$core$IFn$_invoke$arity$2(v__14720__auto__,(0));\n}),new cljs.core.Keyword(null,\x22into\x22,\x22into\x22,-150836029),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22conform-all\x22,\x22cljs.spec.alpha/conform-all\x22,45201917),true,new cljs.core.Keyword(null,\x22kind\x22,\x22kind\x22,-717265803),cljs.core.map_QMARK_,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kind-form\x22,\x22cljs.spec.alpha/kind-form\x22,-1047104697),new cljs.core.Symbol(\x22cljs.core\x22,\x22map?\x22,\x22cljs.core/map?\x22,-1390345523,null),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22describe\x22,\x22cljs.spec.alpha/describe\x22,1883026911),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22map-of\x22,\x22cljs.spec.alpha/map-of\x22,153715093,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22cpred\x22,\x22cljs.spec.alpha/cpred\x22,-693471218),(function (G__44498){\nreturn cljs.core.map_QMARK_(G__44498);\n})], null),null));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22machine\x22,\x22intemporal.fsm/machine\x22,774176589),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22keys\x22,\x22cljs.spec.alpha/keys\x22,1109346032,null),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22req-un\x22,\x22req-un\x22,1074571008),new cljs.core.Keyword(null,\x22opt-un\x22,\x22opt-un\x22,883442496),new cljs.core.Keyword(null,\x22gfn\x22,\x22gfn\x22,791517474),new cljs.core.Keyword(null,\x22pred-exprs\x22,\x22pred-exprs\x22,1792271395),new cljs.core.Keyword(null,\x22keys-pred\x22,\x22keys-pred\x22,858984739),new cljs.core.Keyword(null,\x22opt-keys\x22,\x22opt-keys\x22,1262688261),new cljs.core.Keyword(null,\x22req-specs\x22,\x22req-specs\x22,553962313),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.Keyword(null,\x22req-keys\x22,\x22req-keys\x22,514319221),new cljs.core.Keyword(null,\x22opt-specs\x22,\x22opt-specs\x22,-384905450),new cljs.core.Keyword(null,\x22pred-forms\x22,\x22pred-forms\x22,172611832),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__44500){\nreturn cljs.core.map_QMARK_(G__44500);\n}),(function (G__44500){\nreturn cljs.core.contains_QMARK_(G__44500,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885));\n}),(function (G__44500){\nreturn cljs.core.contains_QMARK_(G__44500,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216));\n})], null),(function (G__44500){\nreturn ((cljs.core.map_QMARK_(G__44500)) \x26\x26 (((cljs.core.contains_QMARK_(G__44500,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885))) \x26\x26 (cljs.core.contains_QMARK_(G__44500,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216))))));\n}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22map?\x22,\x22cljs.core/map?\x22,-1390345523,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)])));\n/**\n * A helper to define a ruleset\n */\nintemporal.fsm.ruleset \x3d (function intemporal$fsm$ruleset(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___44543 \x3d arguments.length;\nvar i__5770__auto___44545 \x3d (0);\nwhile(true){\nif((i__5770__auto___44545 \x3c len__5769__auto___44543)){\nargs__5775__auto__.push((arguments[i__5770__auto___44545]));\n\nvar G__44546 \x3d (i__5770__auto___44545 + (1));\ni__5770__auto___44545 \x3d G__44546;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);\nreturn intemporal.fsm.ruleset.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);\n});\n\n(intemporal.fsm.ruleset.cljs$core$IFn$_invoke$arity$variadic \x3d (function (rules){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,rules);\n}));\n\n(intemporal.fsm.ruleset.cljs$lang$maxFixedArity \x3d (0));\n\n/** @this {Function} */\n(intemporal.fsm.ruleset.cljs$lang$applyTo \x3d (function (seq44512){\nvar self__5755__auto__ \x3d this;\nreturn self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq44512));\n}));\n\n/**\n * Within the context of a ruleset definition, define transitions from\n *   a particular state\n */\nintemporal.fsm.with_state \x3d (function intemporal$fsm$with_state(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___44547 \x3d arguments.length;\nvar i__5770__auto___44548 \x3d (0);\nwhile(true){\nif((i__5770__auto___44548 \x3c len__5769__auto___44547)){\nargs__5775__auto__.push((arguments[i__5770__auto___44548]));\n\nvar G__44549 \x3d (i__5770__auto___44548 + (1));\ni__5770__auto___44548 \x3d G__44549;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((1) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((1)),(0),null)):null);\nreturn intemporal.fsm.with_state.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),argseq__5776__auto__);\n});\n\n(intemporal.fsm.with_state.cljs$core$IFn$_invoke$arity$variadic \x3d (function (state,transitions){\nreturn new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [state,transitions], null);\n}));\n\n(intemporal.fsm.with_state.cljs$lang$maxFixedArity \x3d (1));\n\n/** @this {Function} */\n(intemporal.fsm.with_state.cljs$lang$applyTo \x3d (function (seq44515){\nvar G__44516 \x3d cljs.core.first(seq44515);\nvar seq44515__$1 \x3d cljs.core.next(seq44515);\nvar self__5754__auto__ \x3d this;\nreturn self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__44516,seq44515__$1);\n}));\n\n/**\n * Within the context of a state transition definition, add an event\n *   transition definition.\n */\nintemporal.fsm.upon \x3d (function intemporal$fsm$upon(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___44550 \x3d arguments.length;\nvar i__5770__auto___44551 \x3d (0);\nwhile(true){\nif((i__5770__auto___44551 \x3c len__5769__auto___44550)){\nargs__5775__auto__.push((arguments[i__5770__auto___44551]));\n\nvar G__44552 \x3d (i__5770__auto___44551 + (1));\ni__5770__auto___44551 \x3d G__44552;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((2) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((2)),(0),null)):null);\nreturn intemporal.fsm.upon.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5776__auto__);\n});\n\n(intemporal.fsm.upon.cljs$core$IFn$_invoke$arity$variadic \x3d (function (event,new_state,p__44521){\nvar vec__44522 \x3d p__44521;\nvar actions \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__44522,(0),null);\nreturn new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),event,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new_state,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),actions], null);\n}));\n\n(intemporal.fsm.upon.cljs$lang$maxFixedArity \x3d (2));\n\n/** @this {Function} */\n(intemporal.fsm.upon.cljs$lang$applyTo \x3d (function (seq44517){\nvar G__44518 \x3d cljs.core.first(seq44517);\nvar seq44517__$1 \x3d cljs.core.next(seq44517);\nvar G__44519 \x3d cljs.core.first(seq44517__$1);\nvar seq44517__$2 \x3d cljs.core.next(seq44517__$1);\nvar self__5754__auto__ \x3d this;\nreturn self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__44518,G__44519,seq44517__$2);\n}));\n\n/**\n * Define the target state for a state transition\n */\nintemporal.fsm.transit_to \x3d (function intemporal$fsm$transit_to(x){\nreturn x;\n});\n/**\n * Define effects for a state transition\n */\nintemporal.fsm.and_execute \x3d (function intemporal$fsm$and_execute(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___44558 \x3d arguments.length;\nvar i__5770__auto___44559 \x3d (0);\nwhile(true){\nif((i__5770__auto___44559 \x3c len__5769__auto___44558)){\nargs__5775__auto__.push((arguments[i__5770__auto___44559]));\n\nvar G__44560 \x3d (i__5770__auto___44559 + (1));\ni__5770__auto___44559 \x3d G__44560;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);\nreturn intemporal.fsm.and_execute.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);\n});\n\n(intemporal.fsm.and_execute.cljs$core$IFn$_invoke$arity$variadic \x3d (function (effects){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,effects);\n}));\n\n(intemporal.fsm.and_execute.cljs$lang$maxFixedArity \x3d (0));\n\n/** @this {Function} */\n(intemporal.fsm.and_execute.cljs$lang$applyTo \x3d (function (seq44526){\nvar self__5755__auto__ \x3d this;\nreturn self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq44526));\n}));\n\n/**\n * Yields the next state for a transition\n */\nintemporal.fsm.next \x3d new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634);\n/**\n * Yields all actions for a transition\n */\nintemporal.fsm.actions \x3d new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741);\n/**\n * Yields the first action for a transition\n */\nintemporal.fsm.action \x3d cljs.core.comp.cljs$core$IFn$_invoke$arity$2(cljs.core.first,intemporal.fsm.actions);\n");
SHADOW_ENV.evalLoad("intemporal.automata.js", true , "goog.provide(\x27intemporal.automata\x27);\nintemporal.automata.resource_rules \x3d new cljs.core.PersistentArrayMap(null, 8, [new cljs.core.Keyword(\x22state\x22,\x22init\x22,\x22state/init\x22,-2036161781),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22creating\x22,\x22state/creating\x22,-518318091),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22create\x22,\x22action/create\x22,1832728658)], null)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killed\x22,\x22state/killed\x22,860727406)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22creating\x22,\x22state/creating\x22,-518318091),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22init\x22,\x22state/init\x22,-2036161781)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22starting\x22,\x22state/starting\x22,674059467),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22start\x22,\x22action/start\x22,906325809)], null)], null),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22kill\x22,\x22action/kill\x22,1956070515)], null)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22starting\x22,\x22state/starting\x22,674059467),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22up\x22,\x22state/up\x22,-110768032)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22stopping\x22,\x22state/stopping\x22,859893266),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22up\x22,\x22state/up\x22,-110768032)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22up\x22,\x22state/up\x22,-110768032),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22stopping\x22,\x22state/stopping\x22,859893266),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22stop\x22,\x22action/stop\x22,1397999688)], null)], null),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22kill\x22,\x22action/kill\x22,1956070515)], null)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22killed\x22,\x22event/killed\x22,874658407),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killed\x22,\x22state/killed\x22,860727406)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22killed\x22,\x22state/killed\x22,860727406),cljs.core.PersistentVector.EMPTY], null);\n\n/**\n * @interface\n */\nintemporal.automata.EventHandler \x3d function(){};\n\nvar intemporal$automata$EventHandler$process_event$dyn_45070 \x3d (function (this$,event){\nvar x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);\nvar m__5394__auto__ \x3d (intemporal.automata.process_event[goog.typeOf(x__5393__auto__)]);\nif((!((m__5394__auto__ \x3d\x3d null)))){\nreturn (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(this$,event) : m__5394__auto__.call(null,this$,event));\n} else {\nvar m__5392__auto__ \x3d (intemporal.automata.process_event[\x22_\x22]);\nif((!((m__5392__auto__ \x3d\x3d null)))){\nreturn (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(this$,event) : m__5392__auto__.call(null,this$,event));\n} else {\nthrow cljs.core.missing_protocol(\x22EventHandler.process-event\x22,this$);\n}\n}\n});\n/**\n * Processes the event, returns the next event\n */\nintemporal.automata.process_event \x3d (function intemporal$automata$process_event(this$,event){\nif((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.intemporal$automata$EventHandler$process_event$arity$2 \x3d\x3d null)))))){\nreturn this$.intemporal$automata$EventHandler$process_event$arity$2(this$,event);\n} else {\nreturn intemporal$automata$EventHandler$process_event$dyn_45070(this$,event);\n}\n});\n\nintemporal.automata.make_event_handler \x3d (function intemporal$automata$make_event_handler(){\nif((typeof intemporal !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata.t_intemporal$automata45003 !\x3d\x3d \x27undefined\x27)){\n} else {\n\n/**\n* @constructor\n * @implements {cljs.core.IMeta}\n * @implements {intemporal.automata.EventHandler}\n * @implements {cljs.core.IWithMeta}\n*/\nintemporal.automata.t_intemporal$automata45003 \x3d (function (meta45004){\nthis.meta45004 \x3d meta45004;\nthis.cljs$lang$protocol_mask$partition0$ \x3d 393216;\nthis.cljs$lang$protocol_mask$partition1$ \x3d 0;\n});\n(intemporal.automata.t_intemporal$automata45003.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_45005,meta45004__$1){\nvar self__ \x3d this;\nvar _45005__$1 \x3d this;\nreturn (new intemporal.automata.t_intemporal$automata45003(meta45004__$1));\n}));\n\n(intemporal.automata.t_intemporal$automata45003.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_45005){\nvar self__ \x3d this;\nvar _45005__$1 \x3d this;\nreturn self__.meta45004;\n}));\n\n(intemporal.automata.t_intemporal$automata45003.prototype.intemporal$automata$EventHandler$ \x3d cljs.core.PROTOCOL_SENTINEL);\n\n(intemporal.automata.t_intemporal$automata45003.prototype.intemporal$automata$EventHandler$process_event$arity$2 \x3d (function (this$,event){\nvar self__ \x3d this;\nvar this$__$1 \x3d this;\nconsole.log(\x22Going to process event\x22,event);\n\nvar nxt \x3d (function (){var pred__45011 \x3d cljs.core._EQ_;\nvar expr__45012 \x3d event;\nif(cljs.core.truth_((pred__45011.cljs$core$IFn$_invoke$arity$2 ? pred__45011.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250),expr__45012) : pred__45011.call(null,new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250),expr__45012)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574);\n} else {\nif(cljs.core.truth_((pred__45011.cljs$core$IFn$_invoke$arity$2 ? pred__45011.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574),expr__45012) : pred__45011.call(null,new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574),expr__45012)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307);\n} else {\nif(cljs.core.truth_((pred__45011.cljs$core$IFn$_invoke$arity$2 ? pred__45011.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307),expr__45012) : pred__45011.call(null,new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307),expr__45012)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038);\n} else {\nif(cljs.core.truth_((pred__45011.cljs$core$IFn$_invoke$arity$2 ? pred__45011.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038),expr__45012) : pred__45011.call(null,new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038),expr__45012)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516);\n} else {\nif(cljs.core.truth_((pred__45011.cljs$core$IFn$_invoke$arity$2 ? pred__45011.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516),expr__45012) : pred__45011.call(null,new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516),expr__45012)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798);\n} else {\nif(cljs.core.truth_((pred__45011.cljs$core$IFn$_invoke$arity$2 ? pred__45011.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798),expr__45012) : pred__45011.call(null,new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798),expr__45012)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871);\n} else {\nif(cljs.core.truth_((pred__45011.cljs$core$IFn$_invoke$arity$2 ? pred__45011.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),expr__45012) : pred__45011.call(null,new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),expr__45012)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22killed\x22,\x22event/killed\x22,874658407);\n} else {\nreturn null;\n}\n}\n}\n}\n}\n}\n}\n})();\nreturn nxt;\n}));\n\n(intemporal.automata.t_intemporal$automata45003.getBasis \x3d (function (){\nreturn new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22meta45004\x22,\x22meta45004\x22,-868587815,null)], null);\n}));\n\n(intemporal.automata.t_intemporal$automata45003.cljs$lang$type \x3d true);\n\n(intemporal.automata.t_intemporal$automata45003.cljs$lang$ctorStr \x3d \x22intemporal.automata/t_intemporal$automata45003\x22);\n\n(intemporal.automata.t_intemporal$automata45003.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){\nreturn cljs.core._write(writer__5331__auto__,\x22intemporal.automata/t_intemporal$automata45003\x22);\n}));\n\n/**\n * Positional factory function for intemporal.automata/t_intemporal$automata45003.\n */\nintemporal.automata.__GT_t_intemporal$automata45003 \x3d (function intemporal$automata$make_event_handler_$___GT_t_intemporal$automata45003(meta45004){\nreturn (new intemporal.automata.t_intemporal$automata45003(meta45004));\n});\n\n}\n\nreturn (new intemporal.automata.t_intemporal$automata45003(cljs.core.PersistentArrayMap.EMPTY));\n});\nintemporal.automata.run_fsm_workflow \x3d (function intemporal$automata$run_fsm_workflow(store,rules,init_state,init_event){\nvar stub \x3d (function (){\nif((typeof intemporal !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata.t_intemporal$automata45019 !\x3d\x3d \x27undefined\x27)){\n} else {\n\n/**\n* @constructor\n * @implements {cljs.core.IMeta}\n * @implements {intemporal.automata.EventHandler}\n * @implements {cljs.core.IWithMeta}\n*/\nintemporal.automata.t_intemporal$automata45019 \x3d (function (store,rules,init_state,init_event,meta45020){\nthis.store \x3d store;\nthis.rules \x3d rules;\nthis.init_state \x3d init_state;\nthis.init_event \x3d init_event;\nthis.meta45020 \x3d meta45020;\nthis.cljs$lang$protocol_mask$partition0$ \x3d 393216;\nthis.cljs$lang$protocol_mask$partition1$ \x3d 0;\n});\n(intemporal.automata.t_intemporal$automata45019.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_45021,meta45020__$1){\nvar self__ \x3d this;\nvar _45021__$1 \x3d this;\nreturn (new intemporal.automata.t_intemporal$automata45019(self__.store,self__.rules,self__.init_state,self__.init_event,meta45020__$1));\n}));\n\n(intemporal.automata.t_intemporal$automata45019.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_45021){\nvar self__ \x3d this;\nvar _45021__$1 \x3d this;\nreturn self__.meta45020;\n}));\n\n(intemporal.automata.t_intemporal$automata45019.prototype.intemporal$automata$EventHandler$ \x3d cljs.core.PROTOCOL_SENTINEL);\n\n(intemporal.automata.t_intemporal$automata45019.prototype.intemporal$automata$EventHandler$process_event$arity$2 \x3d (function (this__33123__auto__,event){\nvar self__ \x3d this;\nvar this__33123__auto____$1 \x3d this;\nvar aid__33124__auto__ \x3d new cljs.core.Symbol(\x22intemporal.automata\x22,\x22process-event\x22,\x22intemporal.automata/process-event\x22,-1645671854,null);\nvar act_opts__33125__auto__ \x3d new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22idempotent\x22,\x22idempotent\x22,-1860592338),true], null);\nvar ref__33126__auto__ \x3d new cljs.core.Keyword(null,\x22ref\x22,\x22ref\x22,1289896967).cljs$core$IFn$_invoke$arity$1(intemporal.workflow._STAR_env_STAR_);\nvar root__33127__auto__ \x3d new cljs.core.Keyword(null,\x22root\x22,\x22root\x22,-448657453).cljs$core$IFn$_invoke$arity$1(intemporal.workflow._STAR_env_STAR_);\nreturn intemporal.workflow.enqueue_and_wait(intemporal.workflow._STAR_env_STAR_,intemporal.workflow.internal.create_proto_activity_task(cljs.core.symbol.cljs$core$IFn$_invoke$arity$1(\x22intemporal.automata/EventHandler\x22),ref__33126__auto__,root__33127__auto__,cljs.core.symbol.cljs$core$IFn$_invoke$arity$1(aid__33124__auto__),(function() { \nvar G__45073__delegate \x3d function (impl_PLUS_args__33128__auto__){\nreturn cljs.core.apply.cljs$core$IFn$_invoke$arity$2(intemporal.automata.process_event,impl_PLUS_args__33128__auto__);\n};\nvar G__45073 \x3d function (var_args){\nvar impl_PLUS_args__33128__auto__ \x3d null;\nif (arguments.length \x3e 0) {\nvar G__45074__i \x3d 0, G__45074__a \x3d new Array(arguments.length -  0);\nwhile (G__45074__i \x3c G__45074__a.length) {G__45074__a[G__45074__i] \x3d arguments[G__45074__i + 0]; ++G__45074__i;}\n  impl_PLUS_args__33128__auto__ \x3d new cljs.core.IndexedSeq(G__45074__a,0,null);\n} \nreturn G__45073__delegate.call(this,impl_PLUS_args__33128__auto__);};\nG__45073.cljs$lang$maxFixedArity \x3d 0;\nG__45073.cljs$lang$applyTo \x3d (function (arglist__45075){\nvar impl_PLUS_args__33128__auto__ \x3d cljs.core.seq(arglist__45075);\nreturn G__45073__delegate(impl_PLUS_args__33128__auto__);\n});\nG__45073.cljs$core$IFn$_invoke$arity$variadic \x3d G__45073__delegate;\nreturn G__45073;\n})()\n,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [event], null)));\n}));\n\n(intemporal.automata.t_intemporal$automata45019.getBasis \x3d (function (){\nreturn new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22store\x22,\x22store\x22,-1142205747,null),new cljs.core.Symbol(null,\x22rules\x22,\x22rules\x22,-1455523403,null),new cljs.core.Symbol(null,\x22init-state\x22,\x22init-state\x22,-1203572557,null),new cljs.core.Symbol(null,\x22init-event\x22,\x22init-event\x22,-424164889,null),new cljs.core.Symbol(null,\x22meta45020\x22,\x22meta45020\x22,-493615999,null)], null);\n}));\n\n(intemporal.automata.t_intemporal$automata45019.cljs$lang$type \x3d true);\n\n(intemporal.automata.t_intemporal$automata45019.cljs$lang$ctorStr \x3d \x22intemporal.automata/t_intemporal$automata45019\x22);\n\n(intemporal.automata.t_intemporal$automata45019.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){\nreturn cljs.core._write(writer__5331__auto__,\x22intemporal.automata/t_intemporal$automata45019\x22);\n}));\n\n/**\n * Positional factory function for intemporal.automata/t_intemporal$automata45019.\n */\nintemporal.automata.__GT_t_intemporal$automata45019 \x3d (function intemporal$automata$run_fsm_workflow_$___GT_t_intemporal$automata45019(store__$1,rules__$1,init_state__$1,init_event__$1,meta45020){\nreturn (new intemporal.automata.t_intemporal$automata45019(store__$1,rules__$1,init_state__$1,init_event__$1,meta45020));\n});\n\n}\n\nreturn (new intemporal.automata.t_intemporal$automata45019(store,rules,init_state,init_event,null));\n})()\n;\nvar initstate \x3d new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),rules,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),init_state], null);\nreturn promesa.core.create.cljs$core$IFn$_invoke$arity$1((function (resolve_fn_45026,reject_fn_45025){\nvar loop_fn_45022 \x3d (function intemporal$automata$run_fsm_workflow_$_loop_fn_45022(state,evt){\nreturn promesa.core.fnly.cljs$core$IFn$_invoke$arity$2((function (res_45023,err_45024){\nif((!((err_45024 \x3d\x3d null)))){\nreturn (reject_fn_45025.cljs$core$IFn$_invoke$arity$1 ? reject_fn_45025.cljs$core$IFn$_invoke$arity$1(err_45024) : reject_fn_45025.call(null,err_45024));\n} else {\nif(promesa.core.recur_QMARK_(res_45023)){\npromesa.exec.run_BANG_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22vthread\x22,\x22vthread\x22,441141075),promesa.exec.wrap_bindings((function (){\nreturn cljs.core.apply.cljs$core$IFn$_invoke$arity$2(intemporal$automata$run_fsm_workflow_$_loop_fn_45022,new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192).cljs$core$IFn$_invoke$arity$1(res_45023));\n})));\n\nreturn null;\n} else {\nreturn (resolve_fn_45026.cljs$core$IFn$_invoke$arity$1 ? resolve_fn_45026.cljs$core$IFn$_invoke$arity$1(res_45023) : resolve_fn_45026.call(null,res_45023));\n}\n}\n}),promesa.protocols._mcat(promesa.protocols._promise(null),(function (___28960__auto__){\nreturn promesa.protocols._mcat(promesa.protocols._promise(state),(function (state__$1){\nreturn promesa.protocols._mcat(promesa.protocols._promise(evt),(function (evt__$1){\nreturn promesa.protocols._promise((cljs.core.truth_(evt__$1)?promesa.core.__GT_Recur(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$2(state__$1,evt__$1),(function (){var _STAR_env_STAR__orig_val__45030 \x3d intemporal.workflow._STAR_env_STAR_;\nvar _STAR_env_STAR__temp_val__45031 \x3d cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([intemporal.workflow.default_env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22store\x22,\x22store\x22,1512230022),store], null)], 0));\n(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__temp_val__45031);\n\ntry{return stub.intemporal$automata$EventHandler$process_event$arity$2(null,evt__$1);\n}finally {(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__orig_val__45030);\n}})()], null)):new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216).cljs$core$IFn$_invoke$arity$1(state__$1)));\n}));\n}));\n})));\n});\nreturn promesa.exec.run_BANG_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22vthread\x22,\x22vthread\x22,441141075),promesa.exec.wrap_bindings((function (){\nreturn loop_fn_45022(initstate,init_event);\n})));\n}));\n});\nintemporal.automata.mstore \x3d intemporal.store.make_memstore.cljs$core$IFn$_invoke$arity$0();\nintemporal.automata.worker \x3d intemporal.workflow.start_worker_BANG_.cljs$core$IFn$_invoke$arity$2(intemporal.automata.mstore,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Symbol(\x22intemporal.automata\x22,\x22EventHandler\x22,\x22intemporal.automata/EventHandler\x22,-910431560,null),intemporal.automata.make_event_handler()], null));\nintemporal.automata.set_html_BANG_ \x3d (function intemporal$automata$set_html_BANG_(id,html){\nreturn (document.getElementById(id).innerHTML \x3d html);\n});\nintemporal.automata.set_results_BANG_ \x3d (function intemporal$automata$set_results_BANG_(html){\nreturn intemporal.automata.set_html_BANG_(\x22results\x22,html);\n});\nintemporal.automata.render_table_BANG_ \x3d (function intemporal$automata$render_table_BANG_(id,rows){\nvar header \x3d cljs.core.keys(cljs.core.first(rows));\nvar thead \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22thead\x22,\x22thead\x22,-291875296),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tr\x22,\x22tr\x22,-1424774646),(function (){var iter__5523__auto__ \x3d (function intemporal$automata$render_table_BANG__$_iter__45033(s__45034){\nreturn (new cljs.core.LazySeq(null,(function (){\nvar s__45034__$1 \x3d s__45034;\nwhile(true){\nvar temp__5804__auto__ \x3d cljs.core.seq(s__45034__$1);\nif(temp__5804__auto__){\nvar s__45034__$2 \x3d temp__5804__auto__;\nif(cljs.core.chunked_seq_QMARK_(s__45034__$2)){\nvar c__5521__auto__ \x3d cljs.core.chunk_first(s__45034__$2);\nvar size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);\nvar b__45036 \x3d cljs.core.chunk_buffer(size__5522__auto__);\nif((function (){var i__45035 \x3d (0);\nwhile(true){\nif((i__45035 \x3c size__5522__auto__)){\nvar h \x3d cljs.core._nth(c__5521__auto__,i__45035);\ncljs.core.chunk_append(b__45036,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),h], null));\n\nvar G__45081 \x3d (i__45035 + (1));\ni__45035 \x3d G__45081;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45036),intemporal$automata$render_table_BANG__$_iter__45033(cljs.core.chunk_rest(s__45034__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45036),null);\n}\n} else {\nvar h \x3d cljs.core.first(s__45034__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),h], null),intemporal$automata$render_table_BANG__$_iter__45033(cljs.core.rest(s__45034__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n}),null,null));\n});\nreturn iter__5523__auto__(header);\n})()], null)], null);\nvar tbody \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tbody\x22,\x22tbody\x22,-80678300),(function (){var iter__5523__auto__ \x3d (function intemporal$automata$render_table_BANG__$_iter__45040(s__45041){\nreturn (new cljs.core.LazySeq(null,(function (){\nvar s__45041__$1 \x3d s__45041;\nwhile(true){\nvar temp__5804__auto__ \x3d cljs.core.seq(s__45041__$1);\nif(temp__5804__auto__){\nvar s__45041__$2 \x3d temp__5804__auto__;\nif(cljs.core.chunked_seq_QMARK_(s__45041__$2)){\nvar c__5521__auto__ \x3d cljs.core.chunk_first(s__45041__$2);\nvar size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);\nvar b__45043 \x3d cljs.core.chunk_buffer(size__5522__auto__);\nif((function (){var i__45042 \x3d (0);\nwhile(true){\nif((i__45042 \x3c size__5522__auto__)){\nvar r \x3d cljs.core._nth(c__5521__auto__,i__45042);\ncljs.core.chunk_append(b__45043,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tr\x22,\x22tr\x22,-1424774646),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22class\x22,\x22class\x22,-2030961996),cljs.core.name(cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348)))], null),(function (){var iter__5523__auto__ \x3d ((function (i__45042,r,c__5521__auto__,size__5522__auto__,b__45043,s__45041__$2,temp__5804__auto__,header,thead){\nreturn (function intemporal$automata$render_table_BANG__$_iter__45040_$_iter__45044(s__45045){\nreturn (new cljs.core.LazySeq(null,((function (i__45042,r,c__5521__auto__,size__5522__auto__,b__45043,s__45041__$2,temp__5804__auto__,header,thead){\nreturn (function (){\nvar s__45045__$1 \x3d s__45045;\nwhile(true){\nvar temp__5804__auto____$1 \x3d cljs.core.seq(s__45045__$1);\nif(temp__5804__auto____$1){\nvar s__45045__$2 \x3d temp__5804__auto____$1;\nif(cljs.core.chunked_seq_QMARK_(s__45045__$2)){\nvar c__5521__auto____$1 \x3d cljs.core.chunk_first(s__45045__$2);\nvar size__5522__auto____$1 \x3d cljs.core.count(c__5521__auto____$1);\nvar b__45047 \x3d cljs.core.chunk_buffer(size__5522__auto____$1);\nif((function (){var i__45046 \x3d (0);\nwhile(true){\nif((i__45046 \x3c size__5522__auto____$1)){\nvar h \x3d cljs.core._nth(c__5521__auto____$1,i__45046);\ncljs.core.chunk_append(b__45047,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null));\n\nvar G__45082 \x3d (i__45046 + (1));\ni__45046 \x3d G__45082;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45047),intemporal$automata$render_table_BANG__$_iter__45040_$_iter__45044(cljs.core.chunk_rest(s__45045__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45047),null);\n}\n} else {\nvar h \x3d cljs.core.first(s__45045__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null),intemporal$automata$render_table_BANG__$_iter__45040_$_iter__45044(cljs.core.rest(s__45045__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n});})(i__45042,r,c__5521__auto__,size__5522__auto__,b__45043,s__45041__$2,temp__5804__auto__,header,thead))\n,null,null));\n});})(i__45042,r,c__5521__auto__,size__5522__auto__,b__45043,s__45041__$2,temp__5804__auto__,header,thead))\n;\nreturn iter__5523__auto__(header);\n})()], null));\n\nvar G__45084 \x3d (i__45042 + (1));\ni__45042 \x3d G__45084;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45043),intemporal$automata$render_table_BANG__$_iter__45040(cljs.core.chunk_rest(s__45041__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45043),null);\n}\n} else {\nvar r \x3d cljs.core.first(s__45041__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tr\x22,\x22tr\x22,-1424774646),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22class\x22,\x22class\x22,-2030961996),cljs.core.name(cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348)))], null),(function (){var iter__5523__auto__ \x3d ((function (r,s__45041__$2,temp__5804__auto__,header,thead){\nreturn (function intemporal$automata$render_table_BANG__$_iter__45040_$_iter__45048(s__45049){\nreturn (new cljs.core.LazySeq(null,(function (){\nvar s__45049__$1 \x3d s__45049;\nwhile(true){\nvar temp__5804__auto____$1 \x3d cljs.core.seq(s__45049__$1);\nif(temp__5804__auto____$1){\nvar s__45049__$2 \x3d temp__5804__auto____$1;\nif(cljs.core.chunked_seq_QMARK_(s__45049__$2)){\nvar c__5521__auto__ \x3d cljs.core.chunk_first(s__45049__$2);\nvar size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);\nvar b__45051 \x3d cljs.core.chunk_buffer(size__5522__auto__);\nif((function (){var i__45050 \x3d (0);\nwhile(true){\nif((i__45050 \x3c size__5522__auto__)){\nvar h \x3d cljs.core._nth(c__5521__auto__,i__45050);\ncljs.core.chunk_append(b__45051,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null));\n\nvar G__45087 \x3d (i__45050 + (1));\ni__45050 \x3d G__45087;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45051),intemporal$automata$render_table_BANG__$_iter__45040_$_iter__45048(cljs.core.chunk_rest(s__45049__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__45051),null);\n}\n} else {\nvar h \x3d cljs.core.first(s__45049__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null),intemporal$automata$render_table_BANG__$_iter__45040_$_iter__45048(cljs.core.rest(s__45049__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n}),null,null));\n});})(r,s__45041__$2,temp__5804__auto__,header,thead))\n;\nreturn iter__5523__auto__(header);\n})()], null),intemporal$automata$render_table_BANG__$_iter__45040(cljs.core.rest(s__45041__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n}),null,null));\n});\nreturn iter__5523__auto__(rows);\n})()], null);\nvar tbl \x3d [\x22\x3ctable\x22,\x22 role\x3d\\\x22grid\\\x22\x22,\x22\x3e\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(hiccups.runtime.render_html(thead)),cljs.core.str.cljs$core$IFn$_invoke$arity$1(hiccups.runtime.render_html(tbody)),\x22\x3c/table\x3e\x22].join(\x27\x27);\nreturn intemporal.automata.set_html_BANG_(id,tbl);\n});\nintemporal.automata.render_tables_BANG_ \x3d (function intemporal$automata$render_tables_BANG_(the_store){\nvar tasks \x3d cljs.core.vals(cljs.core.deref(new cljs.core.Keyword(\x22intemporal.store\x22,\x22task-store\x22,\x22intemporal.store/task-store\x22,1271552970).cljs$core$IFn$_invoke$arity$1(the_store)));\nvar events \x3d cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),cljs.core.flatten(cljs.core.vals(cljs.core.deref(new cljs.core.Keyword(\x22intemporal.store\x22,\x22history-store\x22,\x22intemporal.store/history-store\x22,-916561061).cljs$core$IFn$_invoke$arity$1(the_store)))));\nintemporal.automata.render_table_BANG_(\x22tasks\x22,tasks);\n\nintemporal.automata.render_table_BANG_(\x22events\x22,events);\n\nconsole.table(cljs.core.clj__GT_js(tasks));\n\nreturn console.table(cljs.core.clj__GT_js(events));\n});\nintemporal.automata.init \x3d (function intemporal$automata$init(){\nvar res \x3d (function (){var _STAR_env_STAR__orig_val__45064 \x3d intemporal.workflow._STAR_env_STAR_;\nvar _STAR_env_STAR__temp_val__45065 \x3d cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([intemporal.workflow.default_env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22store\x22,\x22store\x22,1512230022),intemporal.automata.mstore], null)], 0));\n(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__temp_val__45065);\n\ntry{return intemporal.automata.run_fsm_workflow(intemporal.automata.mstore,intemporal.automata.resource_rules,new cljs.core.Keyword(\x22state\x22,\x22init\x22,\x22state/init\x22,-2036161781),new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250));\n}finally {(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__orig_val__45064);\n}})();\nreturn promesa.core.catch$.cljs$core$IFn$_invoke$arity$2(promesa.core.then.cljs$core$IFn$_invoke$arity$2(res,(function (r){\nconsole.log(\x22res\x22,r);\n\nintemporal.automata.set_results_BANG_(cljs.core.prn_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([r], 0)));\n\nreturn intemporal.automata.render_tables_BANG_(cljs.core.deref(intemporal.automata.mstore));\n})),(function (r){\nconsole.error(\x22error\x22,r);\n\nreturn intemporal.automata.set_results_BANG_(cljs.core.prn_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([r], 0)));\n}));\n});\n");
SHADOW_ENV.evalLoad("shadow.module.automata.append.js", false , "\nshadow.cljs.devtools.client.env.module_loaded(\x27automata\x27);\n\ntry { intemporal.automata.init(); } catch (e) { console.error(\x22An error occurred when calling (intemporal.automata/init)\x22); throw(e); };\nSHADOW_ENV.setLoaded(\x22intemporal.fsm.js\x22);\nSHADOW_ENV.setLoaded(\x22intemporal.automata.js\x22);\nSHADOW_ENV.setLoaded(\x22shadow.module.automata.append.js\x22);");
SHADOW_ENV.evalLoad("intemporal.fsm.js", true , "goog.provide(\x27intemporal.fsm\x27);\nintemporal.fsm.extract \x3d (function intemporal$fsm$extract(x,k){\nif(cljs.core.map_QMARK_(x)){\nreturn cljs.core.get.cljs$core$IFn$_invoke$arity$2(x,k);\n} else {\nif((x instanceof cljs.core.Keyword)){\nreturn x;\n} else {\nreturn null;\n}\n}\n});\n/**\n * Given a set of rules for states, a current state and event,\n * figure out the next state and potential side effects to perform.\n * \n * Transit can either be called on a *machine*, i.e: a map containing\n * the current state and rules. In this case, an updated machine map\n * will be returned, with a potentially new state and potential actions\n * to perform if any.\n * \n * When called with the three-arity version, transition rules, state,\n * and event are provided separately. The output is then a transition.\n * \n * Both arities throw when no possible transition was found\n */\nintemporal.fsm.transit \x3d (function intemporal$fsm$transit(var_args){\nvar G__31378 \x3d arguments.length;\nswitch (G__31378) {\ncase 2:\nreturn intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));\n\nbreak;\ncase 3:\nreturn intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$3((arguments[(0)]),(arguments[(1)]),(arguments[(2)]));\n\nbreak;\ndefault:\nthrow (new Error([\x22Invalid arity: \x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join(\x27\x27)));\n\n}\n});\n\n(intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$2 \x3d (function (p__31379,event){\nvar map__31380 \x3d p__31379;\nvar map__31380__$1 \x3d cljs.core.__destructure_map(map__31380);\nvar machine \x3d map__31380__$1;\nvar rules \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__31380__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885));\nvar state \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__31380__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216));\nvar map__31381 \x3d intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$3(rules,state,event);\nvar map__31381__$1 \x3d cljs.core.__destructure_map(map__31381);\nvar actions \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__31381__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741));\nvar to \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__31381__$1,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634));\nvar G__31382 \x3d cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(machine,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),to);\nif((!((actions \x3d\x3d null)))){\nreturn cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__31382,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),actions);\n} else {\nreturn G__31382;\n}\n}));\n\n(intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$3 \x3d (function (rules,state,event){\nvar transitions \x3d cljs.core.get.cljs$core$IFn$_invoke$arity$2(rules,intemporal.fsm.extract(state,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)));\nvar e \x3d intemporal.fsm.extract(event,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633));\ncljs.core.println.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([state,event], 0));\n\nvar or__5045__auto__ \x3d cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__31376_SHARP_,p2__31375_SHARP_){\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633).cljs$core$IFn$_invoke$arity$1(p2__31375_SHARP_),e)){\nreturn cljs.core.reduced(p2__31375_SHARP_);\n} else {\nreturn null;\n}\n}),null,transitions);\nif(cljs.core.truth_(or__5045__auto__)){\nreturn or__5045__auto__;\n} else {\nthrow cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(\x22cannot find transition\x22,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),new cljs.core.Keyword(\x22exoscale.ex\x22,\x22not-found\x22,\x22exoscale.ex/not-found\x22,684973639),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),state,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),event], null));\n}\n}));\n\n(intemporal.fsm.transit.cljs$lang$maxFixedArity \x3d 3);\n\n/**\n * Returns a collection of invalid target states used in\n * \n *   Predicate to check whether a given valid ruleset provides\n * a functioning set of rules. Rules are deemed functioning if\n * all target states are known.\n */\nintemporal.fsm.invalid_states \x3d (function intemporal$fsm$invalid_states(rules){\nvar valid_states \x3d cljs.core.set(cljs.core.keys(rules));\nreturn cljs.core.not_empty(cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentHashSet.EMPTY,cljs.core.comp.cljs$core$IFn$_invoke$arity$variadic(cljs.core.mapcat.cljs$core$IFn$_invoke$arity$1(cljs.core.val),cljs.core.map.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)),cljs.core.distinct.cljs$core$IFn$_invoke$arity$0(),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.remove.cljs$core$IFn$_invoke$arity$1(cljs.core.partial.cljs$core$IFn$_invoke$arity$2(cljs.core.contains_QMARK_,valid_states))], 0)),rules));\n});\n/**\n * Perform sanity checks on a rule set, intended to be ran when loading rules.\n * Throws on badly formulated rules\n */\nintemporal.fsm.validate_rules \x3d (function intemporal$fsm$validate_rules(rules){\nif(cljs.spec.alpha.valid_QMARK_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),rules)){\n} else {\nthrow cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(cljs.spec.alpha.explain_str(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),rules),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),new cljs.core.Keyword(\x22exoscale.ex\x22,\x22incorrect\x22,\x22exoscale.ex/incorrect\x22,-1592182378)], null));\n}\n\nvar temp__5804__auto___31400 \x3d intemporal.fsm.invalid_states(rules);\nif(cljs.core.truth_(temp__5804__auto___31400)){\nvar states_31401 \x3d temp__5804__auto___31400;\nthrow cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3(cljs.core.str,\x22transitions contain invalid states: \x22,cljs.core.interpose.cljs$core$IFn$_invoke$arity$2(\x22, \x22,cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.name,states_31401))),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348),new cljs.core.Keyword(\x22exoscale.ex\x22,\x22incorrect\x22,\x22exoscale.ex/incorrect\x22,-1592182378),new cljs.core.Keyword(null,\x22states\x22,\x22states\x22,1389013542),states_31401], null));\n} else {\n}\n\nreturn rules;\n});\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Symbol(\x22cljs.core\x22,\x22qualified-keyword?\x22,\x22cljs.core/qualified-keyword?\x22,-308091478,null),cljs.core.qualified_keyword_QMARK_);\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745),new cljs.core.Symbol(\x22cljs.core\x22,\x22qualified-keyword?\x22,\x22cljs.core/qualified-keyword?\x22,-308091478,null),cljs.core.qualified_keyword_QMARK_);\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Symbol(\x22cljs.core\x22,\x22qualified-keyword?\x22,\x22cljs.core/qualified-keyword?\x22,-308091478,null),cljs.core.qualified_keyword_QMARK_);\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22conform-all\x22,\x22cljs.spec.alpha/conform-all\x22,45201917),true,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kind-form\x22,\x22cljs.spec.alpha/kind-form\x22,-1047104697),null,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22describe\x22,\x22cljs.spec.alpha/describe\x22,1883026911),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22action\x22,\x22intemporal.fsm/action\x22,749777745)),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22cpred\x22,\x22cljs.spec.alpha/cpred\x22,-693471218),(function (G__31383){\nreturn cljs.core.coll_QMARK_(G__31383);\n})], null),null));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22keys\x22,\x22cljs.spec.alpha/keys\x22,1109346032,null),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22req-un\x22,\x22req-un\x22,1074571008),new cljs.core.Keyword(null,\x22opt-un\x22,\x22opt-un\x22,883442496),new cljs.core.Keyword(null,\x22gfn\x22,\x22gfn\x22,791517474),new cljs.core.Keyword(null,\x22pred-exprs\x22,\x22pred-exprs\x22,1792271395),new cljs.core.Keyword(null,\x22keys-pred\x22,\x22keys-pred\x22,858984739),new cljs.core.Keyword(null,\x22opt-keys\x22,\x22opt-keys\x22,1262688261),new cljs.core.Keyword(null,\x22req-specs\x22,\x22req-specs\x22,553962313),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.Keyword(null,\x22req-keys\x22,\x22req-keys\x22,514319221),new cljs.core.Keyword(null,\x22opt-specs\x22,\x22opt-specs\x22,-384905450),new cljs.core.Keyword(null,\x22pred-forms\x22,\x22pred-forms\x22,172611832),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__31384){\nreturn cljs.core.map_QMARK_(G__31384);\n}),(function (G__31384){\nreturn cljs.core.contains_QMARK_(G__31384,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633));\n}),(function (G__31384){\nreturn cljs.core.contains_QMARK_(G__31384,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634));\n})], null),(function (G__31384){\nreturn ((cljs.core.map_QMARK_(G__31384)) \x26\x26 (((cljs.core.contains_QMARK_(G__31384,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633))) \x26\x26 (cljs.core.contains_QMARK_(G__31384,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634))))));\n}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22map?\x22,\x22cljs.core/map?\x22,-1390345523,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)])));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22conform-all\x22,\x22cljs.spec.alpha/conform-all\x22,45201917),true,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kind-form\x22,\x22cljs.spec.alpha/kind-form\x22,-1047104697),null,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22describe\x22,\x22cljs.spec.alpha/describe\x22,1883026911),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22coll-of\x22,\x22cljs.spec.alpha/coll-of\x22,1019430407,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transition\x22,\x22intemporal.fsm/transition\x22,-1631683072)),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22cpred\x22,\x22cljs.spec.alpha/cpred\x22,-693471218),(function (G__31385){\nreturn cljs.core.coll_QMARK_(G__31385);\n})], null),null));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22map-of\x22,\x22cljs.spec.alpha/map-of\x22,153715093,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)),cljs.spec.alpha.every_impl.cljs$core$IFn$_invoke$arity$4(cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22tuple\x22,\x22cljs.spec.alpha/tuple\x22,-415901908,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)),cljs.spec.alpha.tuple_impl.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)], null)),new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kfn\x22,\x22cljs.spec.alpha/kfn\x22,672643897),(function (i__14719__auto__,v__14720__auto__){\nreturn cljs.core.nth.cljs$core$IFn$_invoke$arity$2(v__14720__auto__,(0));\n}),new cljs.core.Keyword(null,\x22into\x22,\x22into\x22,-150836029),cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22conform-all\x22,\x22cljs.spec.alpha/conform-all\x22,45201917),true,new cljs.core.Keyword(null,\x22kind\x22,\x22kind\x22,-717265803),cljs.core.map_QMARK_,new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22kind-form\x22,\x22cljs.spec.alpha/kind-form\x22,-1047104697),new cljs.core.Symbol(\x22cljs.core\x22,\x22map?\x22,\x22cljs.core/map?\x22,-1390345523,null),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22describe\x22,\x22cljs.spec.alpha/describe\x22,1883026911),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22map-of\x22,\x22cljs.spec.alpha/map-of\x22,153715093,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22transitions\x22,\x22intemporal.fsm/transitions\x22,83111518)),new cljs.core.Keyword(\x22cljs.spec.alpha\x22,\x22cpred\x22,\x22cljs.spec.alpha/cpred\x22,-693471218),(function (G__31386){\nreturn cljs.core.map_QMARK_(G__31386);\n})], null),null));\ncljs.spec.alpha.def_impl(new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22machine\x22,\x22intemporal.fsm/machine\x22,774176589),cljs.core.list(new cljs.core.Symbol(\x22cljs.spec.alpha\x22,\x22keys\x22,\x22cljs.spec.alpha/keys\x22,1109346032,null),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)),cljs.spec.alpha.map_spec_impl(cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,\x22req-un\x22,\x22req-un\x22,1074571008),new cljs.core.Keyword(null,\x22opt-un\x22,\x22opt-un\x22,883442496),new cljs.core.Keyword(null,\x22gfn\x22,\x22gfn\x22,791517474),new cljs.core.Keyword(null,\x22pred-exprs\x22,\x22pred-exprs\x22,1792271395),new cljs.core.Keyword(null,\x22keys-pred\x22,\x22keys-pred\x22,858984739),new cljs.core.Keyword(null,\x22opt-keys\x22,\x22opt-keys\x22,1262688261),new cljs.core.Keyword(null,\x22req-specs\x22,\x22req-specs\x22,553962313),new cljs.core.Keyword(null,\x22req\x22,\x22req\x22,-326448303),new cljs.core.Keyword(null,\x22req-keys\x22,\x22req-keys\x22,514319221),new cljs.core.Keyword(null,\x22opt-specs\x22,\x22opt-specs\x22,-384905450),new cljs.core.Keyword(null,\x22pred-forms\x22,\x22pred-forms\x22,172611832),new cljs.core.Keyword(null,\x22opt\x22,\x22opt\x22,-794706369)],[null,null,null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (G__31387){\nreturn cljs.core.map_QMARK_(G__31387);\n}),(function (G__31387){\nreturn cljs.core.contains_QMARK_(G__31387,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885));\n}),(function (G__31387){\nreturn cljs.core.contains_QMARK_(G__31387,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216));\n})], null),(function (G__31387){\nreturn ((cljs.core.map_QMARK_(G__31387)) \x26\x26 (((cljs.core.contains_QMARK_(G__31387,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885))) \x26\x26 (cljs.core.contains_QMARK_(G__31387,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216))))));\n}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22map?\x22,\x22cljs.core/map?\x22,-1390345523,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885))),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22fn\x22,\x22cljs.core/fn\x22,-1065745098,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null)], null),cljs.core.list(new cljs.core.Symbol(\x22cljs.core\x22,\x22contains?\x22,\x22cljs.core/contains?\x22,-976526835,null),new cljs.core.Symbol(null,\x22%\x22,\x22%\x22,-950237169,null),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216)))], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741)], null)])));\n/**\n * A helper to define a ruleset\n */\nintemporal.fsm.ruleset \x3d (function intemporal$fsm$ruleset(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___31402 \x3d arguments.length;\nvar i__5770__auto___31403 \x3d (0);\nwhile(true){\nif((i__5770__auto___31403 \x3c len__5769__auto___31402)){\nargs__5775__auto__.push((arguments[i__5770__auto___31403]));\n\nvar G__31404 \x3d (i__5770__auto___31403 + (1));\ni__5770__auto___31403 \x3d G__31404;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);\nreturn intemporal.fsm.ruleset.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);\n});\n\n(intemporal.fsm.ruleset.cljs$core$IFn$_invoke$arity$variadic \x3d (function (rules){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,rules);\n}));\n\n(intemporal.fsm.ruleset.cljs$lang$maxFixedArity \x3d (0));\n\n/** @this {Function} */\n(intemporal.fsm.ruleset.cljs$lang$applyTo \x3d (function (seq31388){\nvar self__5755__auto__ \x3d this;\nreturn self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq31388));\n}));\n\n/**\n * Within the context of a ruleset definition, define transitions from\n *   a particular state\n */\nintemporal.fsm.with_state \x3d (function intemporal$fsm$with_state(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___31405 \x3d arguments.length;\nvar i__5770__auto___31406 \x3d (0);\nwhile(true){\nif((i__5770__auto___31406 \x3c len__5769__auto___31405)){\nargs__5775__auto__.push((arguments[i__5770__auto___31406]));\n\nvar G__31407 \x3d (i__5770__auto___31406 + (1));\ni__5770__auto___31406 \x3d G__31407;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((1) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((1)),(0),null)):null);\nreturn intemporal.fsm.with_state.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),argseq__5776__auto__);\n});\n\n(intemporal.fsm.with_state.cljs$core$IFn$_invoke$arity$variadic \x3d (function (state,transitions){\nreturn new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [state,transitions], null);\n}));\n\n(intemporal.fsm.with_state.cljs$lang$maxFixedArity \x3d (1));\n\n/** @this {Function} */\n(intemporal.fsm.with_state.cljs$lang$applyTo \x3d (function (seq31389){\nvar G__31390 \x3d cljs.core.first(seq31389);\nvar seq31389__$1 \x3d cljs.core.next(seq31389);\nvar self__5754__auto__ \x3d this;\nreturn self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__31390,seq31389__$1);\n}));\n\n/**\n * Within the context of a state transition definition, add an event\n *   transition definition.\n */\nintemporal.fsm.upon \x3d (function intemporal$fsm$upon(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___31408 \x3d arguments.length;\nvar i__5770__auto___31409 \x3d (0);\nwhile(true){\nif((i__5770__auto___31409 \x3c len__5769__auto___31408)){\nargs__5775__auto__.push((arguments[i__5770__auto___31409]));\n\nvar G__31410 \x3d (i__5770__auto___31409 + (1));\ni__5770__auto___31409 \x3d G__31410;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((2) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((2)),(0),null)):null);\nreturn intemporal.fsm.upon.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),(arguments[(1)]),argseq__5776__auto__);\n});\n\n(intemporal.fsm.upon.cljs$core$IFn$_invoke$arity$variadic \x3d (function (event,new_state,p__31394){\nvar vec__31395 \x3d p__31394;\nvar actions \x3d cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__31395,(0),null);\nreturn new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),event,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new_state,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),actions], null);\n}));\n\n(intemporal.fsm.upon.cljs$lang$maxFixedArity \x3d (2));\n\n/** @this {Function} */\n(intemporal.fsm.upon.cljs$lang$applyTo \x3d (function (seq31391){\nvar G__31392 \x3d cljs.core.first(seq31391);\nvar seq31391__$1 \x3d cljs.core.next(seq31391);\nvar G__31393 \x3d cljs.core.first(seq31391__$1);\nvar seq31391__$2 \x3d cljs.core.next(seq31391__$1);\nvar self__5754__auto__ \x3d this;\nreturn self__5754__auto__.cljs$core$IFn$_invoke$arity$variadic(G__31392,G__31393,seq31391__$2);\n}));\n\n/**\n * Define the target state for a state transition\n */\nintemporal.fsm.transit_to \x3d (function intemporal$fsm$transit_to(x){\nreturn x;\n});\n/**\n * Define effects for a state transition\n */\nintemporal.fsm.and_execute \x3d (function intemporal$fsm$and_execute(var_args){\nvar args__5775__auto__ \x3d [];\nvar len__5769__auto___31411 \x3d arguments.length;\nvar i__5770__auto___31412 \x3d (0);\nwhile(true){\nif((i__5770__auto___31412 \x3c len__5769__auto___31411)){\nargs__5775__auto__.push((arguments[i__5770__auto___31412]));\n\nvar G__31413 \x3d (i__5770__auto___31412 + (1));\ni__5770__auto___31412 \x3d G__31413;\ncontinue;\n} else {\n}\nbreak;\n}\n\nvar argseq__5776__auto__ \x3d ((((0) \x3c args__5775__auto__.length))?(new cljs.core.IndexedSeq(args__5775__auto__.slice((0)),(0),null)):null);\nreturn intemporal.fsm.and_execute.cljs$core$IFn$_invoke$arity$variadic(argseq__5776__auto__);\n});\n\n(intemporal.fsm.and_execute.cljs$core$IFn$_invoke$arity$variadic \x3d (function (effects){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,effects);\n}));\n\n(intemporal.fsm.and_execute.cljs$lang$maxFixedArity \x3d (0));\n\n/** @this {Function} */\n(intemporal.fsm.and_execute.cljs$lang$applyTo \x3d (function (seq31398){\nvar self__5755__auto__ \x3d this;\nreturn self__5755__auto__.cljs$core$IFn$_invoke$arity$variadic(cljs.core.seq(seq31398));\n}));\n\n/**\n * Yields the next state for a transition\n */\nintemporal.fsm.next \x3d new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634);\n/**\n * Yields all actions for a transition\n */\nintemporal.fsm.actions \x3d new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741);\n/**\n * Yields the first action for a transition\n */\nintemporal.fsm.action \x3d cljs.core.comp.cljs$core$IFn$_invoke$arity$2(cljs.core.first,intemporal.fsm.actions);\n");
SHADOW_ENV.evalLoad("intemporal.automata.js", true , "goog.provide(\x27intemporal.automata\x27);\nintemporal.automata.resource_rules \x3d new cljs.core.PersistentArrayMap(null, 8, [new cljs.core.Keyword(\x22state\x22,\x22init\x22,\x22state/init\x22,-2036161781),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22creating\x22,\x22state/creating\x22,-518318091),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22create\x22,\x22action/create\x22,1832728658)], null)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killed\x22,\x22state/killed\x22,860727406)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22creating\x22,\x22state/creating\x22,-518318091),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22init\x22,\x22state/init\x22,-2036161781)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22starting\x22,\x22state/starting\x22,674059467),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22start\x22,\x22action/start\x22,906325809)], null)], null),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22kill\x22,\x22action/kill\x22,1956070515)], null)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22starting\x22,\x22state/starting\x22,674059467),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22up\x22,\x22state/up\x22,-110768032)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22stopping\x22,\x22state/stopping\x22,859893266),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22down\x22,\x22state/down\x22,1337490481)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22up\x22,\x22state/up\x22,-110768032)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22up\x22,\x22state/up\x22,-110768032),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22stopping\x22,\x22state/stopping\x22,859893266),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22stop\x22,\x22action/stop\x22,1397999688)], null)], null),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22actions\x22,\x22intemporal.fsm/actions\x22,1353370741),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\x22action\x22,\x22kill\x22,\x22action/kill\x22,1956070515)], null)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22killed\x22,\x22event/killed\x22,874658407),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killed\x22,\x22state/killed\x22,860727406)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22event\x22,\x22intemporal.fsm/event\x22,-1861445633),new cljs.core.Keyword(\x22event\x22,\x22error\x22,\x22event/error\x22,-1159804082),new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22to\x22,\x22intemporal.fsm/to\x22,-1962402634),new cljs.core.Keyword(\x22state\x22,\x22killing\x22,\x22state/killing\x22,600859092)], null)], null),new cljs.core.Keyword(\x22state\x22,\x22killed\x22,\x22state/killed\x22,860727406),cljs.core.PersistentVector.EMPTY], null);\n\n/**\n * @interface\n */\nintemporal.automata.EventHandler \x3d function(){};\n\nvar intemporal$automata$EventHandler$process_event$dyn_31693 \x3d (function (this$,event){\nvar x__5393__auto__ \x3d (((this$ \x3d\x3d null))?null:this$);\nvar m__5394__auto__ \x3d (intemporal.automata.process_event[goog.typeOf(x__5393__auto__)]);\nif((!((m__5394__auto__ \x3d\x3d null)))){\nreturn (m__5394__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5394__auto__.cljs$core$IFn$_invoke$arity$2(this$,event) : m__5394__auto__.call(null,this$,event));\n} else {\nvar m__5392__auto__ \x3d (intemporal.automata.process_event[\x22_\x22]);\nif((!((m__5392__auto__ \x3d\x3d null)))){\nreturn (m__5392__auto__.cljs$core$IFn$_invoke$arity$2 ? m__5392__auto__.cljs$core$IFn$_invoke$arity$2(this$,event) : m__5392__auto__.call(null,this$,event));\n} else {\nthrow cljs.core.missing_protocol(\x22EventHandler.process-event\x22,this$);\n}\n}\n});\n/**\n * Processes the event, returns the next event\n */\nintemporal.automata.process_event \x3d (function intemporal$automata$process_event(this$,event){\nif((((!((this$ \x3d\x3d null)))) \x26\x26 ((!((this$.intemporal$automata$EventHandler$process_event$arity$2 \x3d\x3d null)))))){\nreturn this$.intemporal$automata$EventHandler$process_event$arity$2(this$,event);\n} else {\nreturn intemporal$automata$EventHandler$process_event$dyn_31693(this$,event);\n}\n});\n\nintemporal.automata.make_event_handler \x3d (function intemporal$automata$make_event_handler(){\nif((typeof intemporal !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata.t_intemporal$automata31659 !\x3d\x3d \x27undefined\x27)){\n} else {\n\n/**\n* @constructor\n * @implements {cljs.core.IMeta}\n * @implements {intemporal.automata.EventHandler}\n * @implements {cljs.core.IWithMeta}\n*/\nintemporal.automata.t_intemporal$automata31659 \x3d (function (meta31660){\nthis.meta31660 \x3d meta31660;\nthis.cljs$lang$protocol_mask$partition0$ \x3d 393216;\nthis.cljs$lang$protocol_mask$partition1$ \x3d 0;\n});\n(intemporal.automata.t_intemporal$automata31659.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_31661,meta31660__$1){\nvar self__ \x3d this;\nvar _31661__$1 \x3d this;\nreturn (new intemporal.automata.t_intemporal$automata31659(meta31660__$1));\n}));\n\n(intemporal.automata.t_intemporal$automata31659.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_31661){\nvar self__ \x3d this;\nvar _31661__$1 \x3d this;\nreturn self__.meta31660;\n}));\n\n(intemporal.automata.t_intemporal$automata31659.prototype.intemporal$automata$EventHandler$ \x3d cljs.core.PROTOCOL_SENTINEL);\n\n(intemporal.automata.t_intemporal$automata31659.prototype.intemporal$automata$EventHandler$process_event$arity$2 \x3d (function (this$,event){\nvar self__ \x3d this;\nvar this$__$1 \x3d this;\nconsole.log(\x22Going to process event\x22,event);\n\nvar nxt \x3d (function (){var pred__31662 \x3d cljs.core._EQ_;\nvar expr__31663 \x3d event;\nif(cljs.core.truth_((pred__31662.cljs$core$IFn$_invoke$arity$2 ? pred__31662.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250),expr__31663) : pred__31662.call(null,new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250),expr__31663)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574);\n} else {\nif(cljs.core.truth_((pred__31662.cljs$core$IFn$_invoke$arity$2 ? pred__31662.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574),expr__31663) : pred__31662.call(null,new cljs.core.Keyword(\x22event\x22,\x22created\x22,\x22event/created\x22,-814408574),expr__31663)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307);\n} else {\nif(cljs.core.truth_((pred__31662.cljs$core$IFn$_invoke$arity$2 ? pred__31662.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307),expr__31663) : pred__31662.call(null,new cljs.core.Keyword(\x22event\x22,\x22start\x22,\x22event/start\x22,-811699307),expr__31663)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038);\n} else {\nif(cljs.core.truth_((pred__31662.cljs$core$IFn$_invoke$arity$2 ? pred__31662.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038),expr__31663) : pred__31662.call(null,new cljs.core.Keyword(\x22event\x22,\x22started\x22,\x22event/started\x22,531610038),expr__31663)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516);\n} else {\nif(cljs.core.truth_((pred__31662.cljs$core$IFn$_invoke$arity$2 ? pred__31662.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516),expr__31663) : pred__31662.call(null,new cljs.core.Keyword(\x22event\x22,\x22stop\x22,\x22event/stop\x22,-2027762516),expr__31663)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798);\n} else {\nif(cljs.core.truth_((pred__31662.cljs$core$IFn$_invoke$arity$2 ? pred__31662.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798),expr__31663) : pred__31662.call(null,new cljs.core.Keyword(\x22event\x22,\x22stopped\x22,\x22event/stopped\x22,-1603032798),expr__31663)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871);\n} else {\nif(cljs.core.truth_((pred__31662.cljs$core$IFn$_invoke$arity$2 ? pred__31662.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),expr__31663) : pred__31662.call(null,new cljs.core.Keyword(\x22event\x22,\x22kill\x22,\x22event/kill\x22,167622871),expr__31663)))){\nreturn new cljs.core.Keyword(\x22event\x22,\x22killed\x22,\x22event/killed\x22,874658407);\n} else {\nreturn null;\n}\n}\n}\n}\n}\n}\n}\n})();\nreturn nxt;\n}));\n\n(intemporal.automata.t_intemporal$automata31659.getBasis \x3d (function (){\nreturn new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22meta31660\x22,\x22meta31660\x22,752338708,null)], null);\n}));\n\n(intemporal.automata.t_intemporal$automata31659.cljs$lang$type \x3d true);\n\n(intemporal.automata.t_intemporal$automata31659.cljs$lang$ctorStr \x3d \x22intemporal.automata/t_intemporal$automata31659\x22);\n\n(intemporal.automata.t_intemporal$automata31659.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){\nreturn cljs.core._write(writer__5331__auto__,\x22intemporal.automata/t_intemporal$automata31659\x22);\n}));\n\n/**\n * Positional factory function for intemporal.automata/t_intemporal$automata31659.\n */\nintemporal.automata.__GT_t_intemporal$automata31659 \x3d (function intemporal$automata$make_event_handler_$___GT_t_intemporal$automata31659(meta31660){\nreturn (new intemporal.automata.t_intemporal$automata31659(meta31660));\n});\n\n}\n\nreturn (new intemporal.automata.t_intemporal$automata31659(cljs.core.PersistentArrayMap.EMPTY));\n});\nintemporal.automata.run_fsm_workflow \x3d (function intemporal$automata$run_fsm_workflow(store,rules,init_state,init_event){\nvar stub \x3d (function (){\nif((typeof intemporal !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata !\x3d\x3d \x27undefined\x27) \x26\x26 (typeof intemporal.automata.t_intemporal$automata31665 !\x3d\x3d \x27undefined\x27)){\n} else {\n\n/**\n* @constructor\n * @implements {cljs.core.IMeta}\n * @implements {intemporal.automata.EventHandler}\n * @implements {cljs.core.IWithMeta}\n*/\nintemporal.automata.t_intemporal$automata31665 \x3d (function (store,rules,init_state,init_event,meta31666){\nthis.store \x3d store;\nthis.rules \x3d rules;\nthis.init_state \x3d init_state;\nthis.init_event \x3d init_event;\nthis.meta31666 \x3d meta31666;\nthis.cljs$lang$protocol_mask$partition0$ \x3d 393216;\nthis.cljs$lang$protocol_mask$partition1$ \x3d 0;\n});\n(intemporal.automata.t_intemporal$automata31665.prototype.cljs$core$IWithMeta$_with_meta$arity$2 \x3d (function (_31667,meta31666__$1){\nvar self__ \x3d this;\nvar _31667__$1 \x3d this;\nreturn (new intemporal.automata.t_intemporal$automata31665(self__.store,self__.rules,self__.init_state,self__.init_event,meta31666__$1));\n}));\n\n(intemporal.automata.t_intemporal$automata31665.prototype.cljs$core$IMeta$_meta$arity$1 \x3d (function (_31667){\nvar self__ \x3d this;\nvar _31667__$1 \x3d this;\nreturn self__.meta31666;\n}));\n\n(intemporal.automata.t_intemporal$automata31665.prototype.intemporal$automata$EventHandler$ \x3d cljs.core.PROTOCOL_SENTINEL);\n\n(intemporal.automata.t_intemporal$automata31665.prototype.intemporal$automata$EventHandler$process_event$arity$2 \x3d (function (this__29786__auto__,event){\nvar self__ \x3d this;\nvar this__29786__auto____$1 \x3d this;\nvar aid__29787__auto__ \x3d new cljs.core.Symbol(\x22intemporal.automata\x22,\x22process-event\x22,\x22intemporal.automata/process-event\x22,-1645671854,null);\nvar act_opts__29788__auto__ \x3d new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22idempotent\x22,\x22idempotent\x22,-1860592338),true], null);\nvar ref__29789__auto__ \x3d new cljs.core.Keyword(null,\x22ref\x22,\x22ref\x22,1289896967).cljs$core$IFn$_invoke$arity$1(intemporal.workflow._STAR_env_STAR_);\nvar root__29790__auto__ \x3d new cljs.core.Keyword(null,\x22root\x22,\x22root\x22,-448657453).cljs$core$IFn$_invoke$arity$1(intemporal.workflow._STAR_env_STAR_);\nreturn intemporal.workflow.enqueue_and_wait(intemporal.workflow._STAR_env_STAR_,intemporal.workflow.internal.create_proto_activity_task(cljs.core.symbol.cljs$core$IFn$_invoke$arity$1(\x22intemporal.automata/EventHandler\x22),ref__29789__auto__,root__29790__auto__,cljs.core.symbol.cljs$core$IFn$_invoke$arity$1(aid__29787__auto__),(function() { \nvar G__31694__delegate \x3d function (impl_PLUS_args__29791__auto__){\nreturn cljs.core.apply.cljs$core$IFn$_invoke$arity$2(intemporal.automata.process_event,impl_PLUS_args__29791__auto__);\n};\nvar G__31694 \x3d function (var_args){\nvar impl_PLUS_args__29791__auto__ \x3d null;\nif (arguments.length \x3e 0) {\nvar G__31695__i \x3d 0, G__31695__a \x3d new Array(arguments.length -  0);\nwhile (G__31695__i \x3c G__31695__a.length) {G__31695__a[G__31695__i] \x3d arguments[G__31695__i + 0]; ++G__31695__i;}\n  impl_PLUS_args__29791__auto__ \x3d new cljs.core.IndexedSeq(G__31695__a,0,null);\n} \nreturn G__31694__delegate.call(this,impl_PLUS_args__29791__auto__);};\nG__31694.cljs$lang$maxFixedArity \x3d 0;\nG__31694.cljs$lang$applyTo \x3d (function (arglist__31696){\nvar impl_PLUS_args__29791__auto__ \x3d cljs.core.seq(arglist__31696);\nreturn G__31694__delegate(impl_PLUS_args__29791__auto__);\n});\nG__31694.cljs$core$IFn$_invoke$arity$variadic \x3d G__31694__delegate;\nreturn G__31694;\n})()\n,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [event], null)));\n}));\n\n(intemporal.automata.t_intemporal$automata31665.getBasis \x3d (function (){\nreturn new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,\x22store\x22,\x22store\x22,-1142205747,null),new cljs.core.Symbol(null,\x22rules\x22,\x22rules\x22,-1455523403,null),new cljs.core.Symbol(null,\x22init-state\x22,\x22init-state\x22,-1203572557,null),new cljs.core.Symbol(null,\x22init-event\x22,\x22init-event\x22,-424164889,null),new cljs.core.Symbol(null,\x22meta31666\x22,\x22meta31666\x22,763748110,null)], null);\n}));\n\n(intemporal.automata.t_intemporal$automata31665.cljs$lang$type \x3d true);\n\n(intemporal.automata.t_intemporal$automata31665.cljs$lang$ctorStr \x3d \x22intemporal.automata/t_intemporal$automata31665\x22);\n\n(intemporal.automata.t_intemporal$automata31665.cljs$lang$ctorPrWriter \x3d (function (this__5330__auto__,writer__5331__auto__,opt__5332__auto__){\nreturn cljs.core._write(writer__5331__auto__,\x22intemporal.automata/t_intemporal$automata31665\x22);\n}));\n\n/**\n * Positional factory function for intemporal.automata/t_intemporal$automata31665.\n */\nintemporal.automata.__GT_t_intemporal$automata31665 \x3d (function intemporal$automata$run_fsm_workflow_$___GT_t_intemporal$automata31665(store__$1,rules__$1,init_state__$1,init_event__$1,meta31666){\nreturn (new intemporal.automata.t_intemporal$automata31665(store__$1,rules__$1,init_state__$1,init_event__$1,meta31666));\n});\n\n}\n\nreturn (new intemporal.automata.t_intemporal$automata31665(store,rules,init_state,init_event,null));\n})()\n;\nvar initstate \x3d new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22rules\x22,\x22intemporal.fsm/rules\x22,-933040885),rules,new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216),init_state], null);\nreturn promesa.core.create.cljs$core$IFn$_invoke$arity$1((function (resolve_fn_31672,reject_fn_31671){\nvar loop_fn_31668 \x3d (function intemporal$automata$run_fsm_workflow_$_loop_fn_31668(state,evt){\nreturn promesa.core.fnly.cljs$core$IFn$_invoke$arity$2((function (res_31669,err_31670){\nif((!((err_31670 \x3d\x3d null)))){\nreturn (reject_fn_31671.cljs$core$IFn$_invoke$arity$1 ? reject_fn_31671.cljs$core$IFn$_invoke$arity$1(err_31670) : reject_fn_31671.call(null,err_31670));\n} else {\nif(promesa.core.recur_QMARK_(res_31669)){\npromesa.exec.run_BANG_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22vthread\x22,\x22vthread\x22,441141075),promesa.exec.wrap_bindings((function (){\nreturn cljs.core.apply.cljs$core$IFn$_invoke$arity$2(intemporal$automata$run_fsm_workflow_$_loop_fn_31668,new cljs.core.Keyword(null,\x22bindings\x22,\x22bindings\x22,1271397192).cljs$core$IFn$_invoke$arity$1(res_31669));\n})));\n\nreturn null;\n} else {\nreturn (resolve_fn_31672.cljs$core$IFn$_invoke$arity$1 ? resolve_fn_31672.cljs$core$IFn$_invoke$arity$1(res_31669) : resolve_fn_31672.call(null,res_31669));\n}\n}\n}),promesa.protocols._mcat(promesa.protocols._promise(null),(function (___28829__auto__){\nreturn promesa.protocols._mcat(promesa.protocols._promise(state),(function (state__$1){\nreturn promesa.protocols._mcat(promesa.protocols._promise(evt),(function (evt__$1){\nreturn promesa.protocols._promise((cljs.core.truth_(evt__$1)?promesa.core.__GT_Recur(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [intemporal.fsm.transit.cljs$core$IFn$_invoke$arity$2(state__$1,evt__$1),(function (){var _STAR_env_STAR__orig_val__31673 \x3d intemporal.workflow._STAR_env_STAR_;\nvar _STAR_env_STAR__temp_val__31674 \x3d cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([intemporal.workflow.default_env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22store\x22,\x22store\x22,1512230022),store], null)], 0));\n(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__temp_val__31674);\n\ntry{return stub.intemporal$automata$EventHandler$process_event$arity$2(null,evt__$1);\n}finally {(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__orig_val__31673);\n}})()], null)):new cljs.core.Keyword(\x22intemporal.fsm\x22,\x22state\x22,\x22intemporal.fsm/state\x22,143854216).cljs$core$IFn$_invoke$arity$1(state__$1)));\n}));\n}));\n})));\n});\nreturn promesa.exec.run_BANG_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22vthread\x22,\x22vthread\x22,441141075),promesa.exec.wrap_bindings((function (){\nreturn loop_fn_31668(initstate,init_event);\n})));\n}));\n});\nintemporal.automata.mstore \x3d intemporal.store.make_memstore.cljs$core$IFn$_invoke$arity$0();\nintemporal.automata.worker \x3d intemporal.workflow.start_worker_BANG_.cljs$core$IFn$_invoke$arity$2(intemporal.automata.mstore,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Symbol(\x22intemporal.automata\x22,\x22EventHandler\x22,\x22intemporal.automata/EventHandler\x22,-910431560,null),intemporal.automata.make_event_handler()], null));\nintemporal.automata.set_html_BANG_ \x3d (function intemporal$automata$set_html_BANG_(id,html){\nreturn (document.getElementById(id).innerHTML \x3d html);\n});\nintemporal.automata.set_results_BANG_ \x3d (function intemporal$automata$set_results_BANG_(html){\nreturn intemporal.automata.set_html_BANG_(\x22results\x22,html);\n});\nintemporal.automata.render_table_BANG_ \x3d (function intemporal$automata$render_table_BANG_(id,rows){\nvar header \x3d cljs.core.keys(cljs.core.first(rows));\nvar thead \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22thead\x22,\x22thead\x22,-291875296),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tr\x22,\x22tr\x22,-1424774646),(function (){var iter__5523__auto__ \x3d (function intemporal$automata$render_table_BANG__$_iter__31675(s__31676){\nreturn (new cljs.core.LazySeq(null,(function (){\nvar s__31676__$1 \x3d s__31676;\nwhile(true){\nvar temp__5804__auto__ \x3d cljs.core.seq(s__31676__$1);\nif(temp__5804__auto__){\nvar s__31676__$2 \x3d temp__5804__auto__;\nif(cljs.core.chunked_seq_QMARK_(s__31676__$2)){\nvar c__5521__auto__ \x3d cljs.core.chunk_first(s__31676__$2);\nvar size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);\nvar b__31678 \x3d cljs.core.chunk_buffer(size__5522__auto__);\nif((function (){var i__31677 \x3d (0);\nwhile(true){\nif((i__31677 \x3c size__5522__auto__)){\nvar h \x3d cljs.core._nth(c__5521__auto__,i__31677);\ncljs.core.chunk_append(b__31678,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),h], null));\n\nvar G__31697 \x3d (i__31677 + (1));\ni__31677 \x3d G__31697;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31678),intemporal$automata$render_table_BANG__$_iter__31675(cljs.core.chunk_rest(s__31676__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31678),null);\n}\n} else {\nvar h \x3d cljs.core.first(s__31676__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),h], null),intemporal$automata$render_table_BANG__$_iter__31675(cljs.core.rest(s__31676__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n}),null,null));\n});\nreturn iter__5523__auto__(header);\n})()], null)], null);\nvar tbody \x3d new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tbody\x22,\x22tbody\x22,-80678300),(function (){var iter__5523__auto__ \x3d (function intemporal$automata$render_table_BANG__$_iter__31679(s__31680){\nreturn (new cljs.core.LazySeq(null,(function (){\nvar s__31680__$1 \x3d s__31680;\nwhile(true){\nvar temp__5804__auto__ \x3d cljs.core.seq(s__31680__$1);\nif(temp__5804__auto__){\nvar s__31680__$2 \x3d temp__5804__auto__;\nif(cljs.core.chunked_seq_QMARK_(s__31680__$2)){\nvar c__5521__auto__ \x3d cljs.core.chunk_first(s__31680__$2);\nvar size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);\nvar b__31682 \x3d cljs.core.chunk_buffer(size__5522__auto__);\nif((function (){var i__31681 \x3d (0);\nwhile(true){\nif((i__31681 \x3c size__5522__auto__)){\nvar r \x3d cljs.core._nth(c__5521__auto__,i__31681);\ncljs.core.chunk_append(b__31682,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tr\x22,\x22tr\x22,-1424774646),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22class\x22,\x22class\x22,-2030961996),cljs.core.name(cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348)))], null),(function (){var iter__5523__auto__ \x3d ((function (i__31681,r,c__5521__auto__,size__5522__auto__,b__31682,s__31680__$2,temp__5804__auto__,header,thead){\nreturn (function intemporal$automata$render_table_BANG__$_iter__31679_$_iter__31683(s__31684){\nreturn (new cljs.core.LazySeq(null,((function (i__31681,r,c__5521__auto__,size__5522__auto__,b__31682,s__31680__$2,temp__5804__auto__,header,thead){\nreturn (function (){\nvar s__31684__$1 \x3d s__31684;\nwhile(true){\nvar temp__5804__auto____$1 \x3d cljs.core.seq(s__31684__$1);\nif(temp__5804__auto____$1){\nvar s__31684__$2 \x3d temp__5804__auto____$1;\nif(cljs.core.chunked_seq_QMARK_(s__31684__$2)){\nvar c__5521__auto____$1 \x3d cljs.core.chunk_first(s__31684__$2);\nvar size__5522__auto____$1 \x3d cljs.core.count(c__5521__auto____$1);\nvar b__31686 \x3d cljs.core.chunk_buffer(size__5522__auto____$1);\nif((function (){var i__31685 \x3d (0);\nwhile(true){\nif((i__31685 \x3c size__5522__auto____$1)){\nvar h \x3d cljs.core._nth(c__5521__auto____$1,i__31685);\ncljs.core.chunk_append(b__31686,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null));\n\nvar G__31698 \x3d (i__31685 + (1));\ni__31685 \x3d G__31698;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31686),intemporal$automata$render_table_BANG__$_iter__31679_$_iter__31683(cljs.core.chunk_rest(s__31684__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31686),null);\n}\n} else {\nvar h \x3d cljs.core.first(s__31684__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null),intemporal$automata$render_table_BANG__$_iter__31679_$_iter__31683(cljs.core.rest(s__31684__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n});})(i__31681,r,c__5521__auto__,size__5522__auto__,b__31682,s__31680__$2,temp__5804__auto__,header,thead))\n,null,null));\n});})(i__31681,r,c__5521__auto__,size__5522__auto__,b__31682,s__31680__$2,temp__5804__auto__,header,thead))\n;\nreturn iter__5523__auto__(header);\n})()], null));\n\nvar G__31699 \x3d (i__31681 + (1));\ni__31681 \x3d G__31699;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31682),intemporal$automata$render_table_BANG__$_iter__31679(cljs.core.chunk_rest(s__31680__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31682),null);\n}\n} else {\nvar r \x3d cljs.core.first(s__31680__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22tr\x22,\x22tr\x22,-1424774646),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22class\x22,\x22class\x22,-2030961996),cljs.core.name(cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,new cljs.core.Keyword(null,\x22type\x22,\x22type\x22,1174270348)))], null),(function (){var iter__5523__auto__ \x3d ((function (r,s__31680__$2,temp__5804__auto__,header,thead){\nreturn (function intemporal$automata$render_table_BANG__$_iter__31679_$_iter__31687(s__31688){\nreturn (new cljs.core.LazySeq(null,(function (){\nvar s__31688__$1 \x3d s__31688;\nwhile(true){\nvar temp__5804__auto____$1 \x3d cljs.core.seq(s__31688__$1);\nif(temp__5804__auto____$1){\nvar s__31688__$2 \x3d temp__5804__auto____$1;\nif(cljs.core.chunked_seq_QMARK_(s__31688__$2)){\nvar c__5521__auto__ \x3d cljs.core.chunk_first(s__31688__$2);\nvar size__5522__auto__ \x3d cljs.core.count(c__5521__auto__);\nvar b__31690 \x3d cljs.core.chunk_buffer(size__5522__auto__);\nif((function (){var i__31689 \x3d (0);\nwhile(true){\nif((i__31689 \x3c size__5522__auto__)){\nvar h \x3d cljs.core._nth(c__5521__auto__,i__31689);\ncljs.core.chunk_append(b__31690,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null));\n\nvar G__31700 \x3d (i__31689 + (1));\ni__31689 \x3d G__31700;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31690),intemporal$automata$render_table_BANG__$_iter__31679_$_iter__31687(cljs.core.chunk_rest(s__31688__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__31690),null);\n}\n} else {\nvar h \x3d cljs.core.first(s__31688__$2);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\x22td\x22,\x22td\x22,1479933353),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.get.cljs$core$IFn$_invoke$arity$2(r,h)], 0))], null),intemporal$automata$render_table_BANG__$_iter__31679_$_iter__31687(cljs.core.rest(s__31688__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n}),null,null));\n});})(r,s__31680__$2,temp__5804__auto__,header,thead))\n;\nreturn iter__5523__auto__(header);\n})()], null),intemporal$automata$render_table_BANG__$_iter__31679(cljs.core.rest(s__31680__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n}),null,null));\n});\nreturn iter__5523__auto__(rows);\n})()], null);\nvar tbl \x3d [\x22\x3ctable\x22,\x22 role\x3d\\\x22grid\\\x22\x22,\x22\x3e\x22,cljs.core.str.cljs$core$IFn$_invoke$arity$1(hiccups.runtime.render_html(thead)),cljs.core.str.cljs$core$IFn$_invoke$arity$1(hiccups.runtime.render_html(tbody)),\x22\x3c/table\x3e\x22].join(\x27\x27);\nreturn intemporal.automata.set_html_BANG_(id,tbl);\n});\nintemporal.automata.render_tables_BANG_ \x3d (function intemporal$automata$render_tables_BANG_(the_store){\nvar tasks \x3d cljs.core.vals(cljs.core.deref(new cljs.core.Keyword(\x22intemporal.store\x22,\x22task-store\x22,\x22intemporal.store/task-store\x22,1271552970).cljs$core$IFn$_invoke$arity$1(the_store)));\nvar events \x3d cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\x22id\x22,\x22id\x22,-1388402092),cljs.core.flatten(cljs.core.vals(cljs.core.deref(new cljs.core.Keyword(\x22intemporal.store\x22,\x22history-store\x22,\x22intemporal.store/history-store\x22,-916561061).cljs$core$IFn$_invoke$arity$1(the_store)))));\nintemporal.automata.render_table_BANG_(\x22tasks\x22,tasks);\n\nintemporal.automata.render_table_BANG_(\x22events\x22,events);\n\nconsole.table(cljs.core.clj__GT_js(tasks));\n\nreturn console.table(cljs.core.clj__GT_js(events));\n});\nintemporal.automata.init \x3d (function intemporal$automata$init(){\nvar res \x3d (function (){var _STAR_env_STAR__orig_val__31691 \x3d intemporal.workflow._STAR_env_STAR_;\nvar _STAR_env_STAR__temp_val__31692 \x3d cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([intemporal.workflow.default_env,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\x22store\x22,\x22store\x22,1512230022),intemporal.automata.mstore], null)], 0));\n(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__temp_val__31692);\n\ntry{return intemporal.automata.run_fsm_workflow(intemporal.automata.mstore,intemporal.automata.resource_rules,new cljs.core.Keyword(\x22state\x22,\x22init\x22,\x22state/init\x22,-2036161781),new cljs.core.Keyword(\x22event\x22,\x22create\x22,\x22event/create\x22,-1323031250));\n}finally {(intemporal.workflow._STAR_env_STAR_ \x3d _STAR_env_STAR__orig_val__31691);\n}})();\nreturn promesa.core.catch$.cljs$core$IFn$_invoke$arity$2(promesa.core.then.cljs$core$IFn$_invoke$arity$2(res,(function (r){\nconsole.log(\x22res\x22,r);\n\nintemporal.automata.set_results_BANG_(cljs.core.prn_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([r], 0)));\n\nreturn intemporal.automata.render_tables_BANG_(cljs.core.deref(intemporal.automata.mstore));\n})),(function (r){\nconsole.error(\x22error\x22,r);\n\nreturn intemporal.automata.set_results_BANG_(cljs.core.prn_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([r], 0)));\n}));\n});\n");
SHADOW_ENV.evalLoad("shadow.module.automata.append.js", false , "\nshadow.cljs.devtools.client.env.module_loaded(\x27automata\x27);\n\ntry { intemporal.automata.init(); } catch (e) { console.error(\x22An error occurred when calling (intemporal.automata/init)\x22); throw(e); };\nSHADOW_ENV.setLoaded(\x22intemporal.fsm.js\x22);\nSHADOW_ENV.setLoaded(\x22intemporal.automata.js\x22);\nSHADOW_ENV.setLoaded(\x22shadow.module.automata.append.js\x22);");